!function(t,s,i){"use strict";function a(){this.ajaxUrl="/bitrix/components/redsign/lightbasket.basket/ajax.php",this.inBasketProducts=[]}i.RS||(i.RS={}),!i.RS.Basket&&t&&(a.prototype.inbasket=function(s,i){return i=i||!1,s&&(s=t.type.isArray(s)?s:[s],i?this.inBasketProducts=s:s.forEach(function(s,i){t.util.array_search(s,this.inBasketProducts)<0&&this.inBasketProducts.push(s)}.bind(this))),this.inBasketProducts},a.prototype.frombasket=function(t){var s=[];this.inBasketProducts.forEach(function(i,a){i!=t&&s.push(i)}.bind(this)),this.inBasketProducts=s},a.prototype.add=function(s,i){var a={action:"add2basket"};return a.product_id=s,a.sessid=t.bitrix_sessid(),i&&(a.quantity=i),t.ajax.post(this.ajaxUrl,a,function(i){(i=t.parseJSON(i))&&(this.inbasket(s,!1),t.onCustomEvent("add2basket.rs_lightbasket"))}.bind(this))},a.prototype.updateQuantity=function(s,i){var a={action:"update"};return a.id=s,a.quantity=i,a.sessid=t.bitrix_sessid(),t.ajax.post(this.ajaxUrl,a,(function(s){(s=t.parseJSON(s))&&t.onCustomEvent("update.rs_lightbasket",[s.DATA])}))},a.prototype.delete=function(s){var i={action:"delete"};return i.id=s,i.sessid=t.bitrix_sessid(),t.ajax.post(this.ajaxUrl,i,function(s){(s=t.parseJSON(s))&&(this.frombasket(s.DATA.ID),t.onCustomEvent("delete.rs_lightbasket",[s.DATA]))}.bind(this))},a.prototype.clear=function(){var s={action:"clear"};return s.sessid=t.bitrix_sessid(),t.ajax.post(this.ajaxUrl,s,function(s){(s=t.parseJSON(s))&&(this.inbasket([],!0),t.onCustomEvent("clear.rs_lightbasket",[s.DATA]))}.bind(this))},i.Basket=new a)}(BX,document,window);