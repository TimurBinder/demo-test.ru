!function(t){t.JCCatalogCompareList||(t.JCCatalogCompareList=function(t){this.obCompare=null,this.obAdminPanel=null,this.visual=t.VISUAL,this.visual.LIST=this.visual.ID+"_tbl",this.visual.ROW=this.visual.ID+"_row_",this.visual.COUNT=this.visual.ID+"_count",this.ajax=t.AJAX,this.position=t.POSITION,BX.ready(BX.proxy(this.init,this))},t.JCCatalogCompareList.prototype.init=function(){this.obCompare=BX(this.visual.ID),this.obCompare&&(BX.addCustomEvent(t,"OnCompareChange",BX.proxy(this.reload,this)),BX.bindDelegate(this.obCompare,"click",{tagName:"a"},BX.proxy(this.deleteCompare,this)),this.position.fixed&&"top"===this.position.align.vertical&&(this.obAdminPanel=BX("bx-panel"),this.obAdminPanel&&(this.setVerticalAlign(),BX.addCustomEvent(t,"onTopPanelCollapse",BX.proxy(this.setVerticalAlign,this)))))},t.JCCatalogCompareList.prototype.reload=function(){BX.showWait(this.obCompare),BX.ajax.post(this.ajax.url,this.ajax.params,BX.proxy(this.reloadResult,this))},t.JCCatalogCompareList.prototype.reloadResult=function(t){BX.closeWait(),this.obCompare.innerHTML=t,BX.style(this.obCompare,"display","block")},t.JCCatalogCompareList.prototype.deleteCompare=function(){var t,i,o=BX.proxy_context;o&&o.hasAttribute("data-id")&&(t=parseInt(o.getAttribute("data-id"),10),isNaN(t)||(BX.showWait(this.obCompare),i=this.ajax.url+this.ajax.templates.delete+t.toString(),BX.ajax.loadJSON(i,this.ajax.params,BX.proxy(this.deleteCompareResult,this))))},t.JCCatalogCompareList.prototype.deleteCompareResult=function(t){var i,o,a,e,s;if(BX.closeWait(),"object"==typeof t&&t.STATUS&&"OK"===t.STATUS&&t.ID&&(BX.onCustomEvent("onCatalogDeleteCompare",[t.ID]),i=BX(this.visual.LIST)))if(i.rows.length>1){for(a=this.visual.ROW+t.ID,o=0;o<i.rows.length;o++)i.rows[o].id===a&&i.deleteRow(o);i=null,(BX.type.isNotEmptyString(t.COUNT)||BX.type.isNumber(t.COUNT))&&(s=parseInt(t.COUNT,10),isNaN(s)||((e=BX(this.visual.COUNT))&&(e.innerHTML=s.toString(),e=null),BX.style(this.obCompare,"display",s>0?"block":"none")))}else this.reload()},t.JCCatalogCompareList.prototype.setVerticalAlign=function(){var t;this.obCompare&&this.obAdminPanel&&(t=parseInt(this.obAdminPanel.offsetHeight,10),isNaN(t)&&(t=0),t+=5,BX.style(this.obCompare,"top",t.toString()+"px"))})}(window);